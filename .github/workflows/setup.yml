name: æ‰¹é‡åˆ›å»ºé¡¹ç›®æ–‡ä»¶

on:
  workflow_dispatch:
    inputs:
      force_recreate:
        description: 'å¼ºåˆ¶é‡æ–°åˆ›å»ºæ‰€æœ‰æ–‡ä»¶'
        required: false
        default: 'false'
        type: boolean

permissions:
  contents: write

jobs:
  create-all-files:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: åˆ›å»ºç›®å½•ç»“æ„
      run: |
        echo "ğŸ—ï¸ åˆ›å»ºç›®å½•ç»“æ„..."
        mkdir -p config
        mkdir -p workflows/blueprints/competitor_intelligence
        mkdir -p workflows/blueprints/academic_research  
        mkdir -p workflows/blueprints/opensource_ecosystem
        mkdir -p workflows/blueprints/ai_analysis
        mkdir -p workflows/docs
        mkdir -p workflows/schemas
        mkdir -p scripts
        mkdir -p utils
        mkdir -p tests
        mkdir -p data/sample
        mkdir -p data/schemas
        mkdir -p docs
        mkdir -p deployment/docker
        mkdir -p deployment/kubernetes
        echo "âœ… ç›®å½•åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºPythonåŒ…æ–‡ä»¶
      run: |
        echo "ğŸ“¦ åˆ›å»ºPythonåŒ…æ–‡ä»¶..."
        echo "# ICT TechInsight Scripts Package" > scripts/__init__.py
        echo "# ICT TechInsight Utils Package" > utils/__init__.py  
        echo "# ICT TechInsight Tests Package" > tests/__init__.py
        echo "# ICT TechInsight Config Package" > config/__init__.py
        echo "âœ… PythonåŒ…æ–‡ä»¶åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºrequirements.txt
      run: |
        echo "ğŸ“‹ åˆ›å»ºrequirements.txt..."
        cat > requirements.txt << 'EOF'
        # æ ¸å¿ƒä¾èµ–
        requests>=2.31.0
        jsonschema>=4.17.0
        python-dateutil>=2.8.2
        
        # æ•°æ®å¤„ç†
        pandas>=2.0.0
        numpy>=1.24.0
        
        # é…ç½®ç®¡ç†
        python-dotenv>=1.0.0
        pyyaml>=6.0
        
        # æµ‹è¯•æ¡†æ¶
        pytest>=7.3.0
        pytest-cov>=4.1.0
        
        # APIå®¢æˆ·ç«¯
        google-api-python-client>=2.86.0
        google-auth-httplib2>=0.1.0
        google-auth-oauthlib>=1.0.0
        
        # å¼€å‘å·¥å…·
        black>=23.0.0
        flake8>=6.0.0
        mypy>=1.3.0
        EOF
        echo "âœ… requirements.txt åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºé…ç½®æ–‡ä»¶
      run: |
        echo "âš™ï¸ åˆ›å»ºé…ç½®æ–‡ä»¶..."
        
        # åˆ›å»ºsettings.py
        cat > config/settings.py << 'EOF'
        """
        ICT TechInsight é…ç½®è®¾ç½®
        """
        import os
        from pathlib import Path
        
        # é¡¹ç›®æ ¹ç›®å½•
        PROJECT_ROOT = Path(__file__).parent.parent
        
        # APIé…ç½®
        MAKE_API_BASE_URL = "https://us1.make.com/api/v2"
        MAKE_API_KEY = os.getenv("MAKE_API_KEY", "")
        MAKE_TEAM_ID = os.getenv("MAKE_TEAM_ID", "")
        
        # é‚®ä»¶é…ç½®
        ALERT_EMAIL = os.getenv("ALERT_EMAIL", "")
        SMTP_SERVER = os.getenv("SMTP_SERVER", "smtp.gmail.com")
        SMTP_PORT = int(os.getenv("SMTP_PORT", "587"))
        SMTP_USERNAME = os.getenv("SMTP_USERNAME", "")
        SMTP_PASSWORD = os.getenv("SMTP_PASSWORD", "")
        
        # æ•°æ®ç›®å½•
        DATA_DIR = PROJECT_ROOT / "data"
        BLUEPRINTS_DIR = PROJECT_ROOT / "workflows" / "blueprints"
        LOGS_DIR = PROJECT_ROOT / "logs"
        
        # åˆ›å»ºå¿…è¦ç›®å½•
        LOGS_DIR.mkdir(exist_ok=True)
        EOF
        
        # åˆ›å»ºAPIå¯†é’¥ç¤ºä¾‹
        cat > config/api_keys.example.env << 'EOF'
        # Make.com APIé…ç½®
        MAKE_API_KEY=your_make_api_key_here
        MAKE_TEAM_ID=your_team_id_here
        
        # é‚®ä»¶é…ç½®
        ALERT_EMAIL=your_alert_email@example.com
        SMTP_USERNAME=your_smtp_username
        SMTP_PASSWORD=your_smtp_password
        
        # å…¶ä»–APIå¯†é’¥
        OPENAI_API_KEY=your_openai_key_here
        XAI_API_KEY=your_xai_key_here
        NEWS_API_KEY=your_news_api_key_here
        SERPAPI_KEY=your_serpapi_key_here
        
        # GoogleæœåŠ¡é…ç½®
        GOOGLE_SHEETS_CREDENTIALS=path_to_credentials.json
        EOF
        
        echo "âœ… é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºå·¥å…·æ¨¡å—
      run: |
        echo "ğŸ”§ åˆ›å»ºå·¥å…·æ¨¡å—..."
        
        # åˆ›å»ºlogger.py
        cat > utils/logger.py << 'EOF'
        """
        æ—¥å¿—é…ç½®æ¨¡å—
        """
        import logging
        import sys
        from pathlib import Path
        from datetime import datetime
        
        def setup_logger(name: str, level: str = "INFO") -> logging.Logger:
            """è®¾ç½®æ—¥å¿—è®°å½•å™¨"""
            
            # åˆ›å»ºæ—¥å¿—ç›®å½•
            log_dir = Path("logs")
            log_dir.mkdir(exist_ok=True)
            
            # é…ç½®æ—¥å¿—æ ¼å¼
            formatter = logging.Formatter(
                '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
            )
            
            # åˆ›å»ºlogger
            logger = logging.getLogger(name)
            logger.setLevel(getattr(logging, level.upper()))
            
            # é¿å…é‡å¤æ·»åŠ handler
            if logger.handlers:
                return logger
            
            # æ§åˆ¶å°è¾“å‡º
            console_handler = logging.StreamHandler(sys.stdout)
            console_handler.setFormatter(formatter)
            logger.addHandler(console_handler)
            
            # æ–‡ä»¶è¾“å‡º
            log_file = log_dir / f"{name}_{datetime.now().strftime('%Y%m%d')}.log"
            file_handler = logging.FileHandler(log_file, encoding='utf-8')
            file_handler.setFormatter(formatter)
            logger.addHandler(file_handler)
            
            return logger
        EOF
        
        # åˆ›å»ºjson_processor.py
        cat > utils/json_processor.py << 'EOF'
        """
        JSONå¤„ç†å·¥å…·ç±»
        """
        import json
        import re
        from pathlib import Path
        from typing import Dict, Any
        from datetime import datetime
        
        class JSONProcessor:
            def __init__(self):
                self.processed_count = 0
                
            def clean_json_file(self, file_path: Path) -> Dict:
                """æ¸…ç†JSONæ–‡ä»¶ï¼Œç§»é™¤æ³¨é‡Šå’Œæ ¼å¼åŒ–"""
                try:
                    with open(file_path, 'r', encoding='utf-8') as f:
                        content = f.read()
                    
                    # ç§»é™¤å•è¡Œæ³¨é‡Š //
                    content = re.sub(r'//.*$', '', content, flags=re.MULTILINE)
                    
                    # ç§»é™¤å¤šè¡Œæ³¨é‡Š /* */
                    content = re.sub(r'/\*.*?\*/', '', content, flags=re.DOTALL)
                    
                    # ç§»é™¤è¡Œé¦–çš„ ##
                    content = re.sub(r'^\s*##\s*', '', content, flags=re.MULTILINE)
                    
                    # è§£æJSON
                    data = json.loads(content)
                    
                    return {
                        "success": True,
                        "data": data,
                        "message": "JSONæ¸…ç†æˆåŠŸ"
                    }
                    
                except json.JSONDecodeError as e:
                    return {
                        "success": False,
                        "data": None,
                        "message": f"JSONè§£æé”™è¯¯: {str(e)}"
                    }
                except Exception as e:
                    return {
                        "success": False,
                        "data": None,
                        "message": f"å¤„ç†é”™è¯¯: {str(e)}"
                    }
        EOF
        
        echo "âœ… å·¥å…·æ¨¡å—åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºè„šæœ¬æ–‡ä»¶
      run: |
        echo "ğŸ“ åˆ›å»ºè„šæœ¬æ–‡ä»¶..."
        
        # åˆ›å»ºè“å›¾ç®¡ç†å™¨
        cat > scripts/blueprint_manager.py << 'EOF'
        #!/usr/bin/env python3
        """
        ICT TechInsight Blueprint Manager
        ç®¡ç†Make.com workflowè“å›¾çš„å·¥å…·
        """
        
        import json
        import os
        import shutil
        from datetime import datetime
        from pathlib import Path
        from typing import Dict, List, Optional
        import argparse
        
        class BlueprintManager:
            def __init__(self, base_path: str = "workflows/blueprints"):
                self.base_path = Path(base_path)
                
                # å·¥ä½œæµæ˜ å°„
                self.workflow_mapping = {
                    "competitor": "competitor_intelligence",
                    "academic": "academic_research", 
                    "opensource": "opensource_ecosystem",
                    "ai_analysis": "ai_analysis"
                }
            
            def organize_blueprints(self):
                """æ•´ç†è“å›¾æ–‡ä»¶åˆ°ç›¸åº”ç›®å½•"""
                print("å¼€å§‹æ•´ç†è“å›¾æ–‡ä»¶...")
                
                blueprint_files = {
                    "Competitor_Intelligence_Collection.blueprint.json": "competitor_intelligence",
                    "Academic_Research_Collection.blueprint.json": "academic_research",
                    "OpenSource_Ecosystem_Collection.blueprint.json": "opensource_ecosystem", 
                    "ICT_TechInsight_MultiModel_AI_Analysis_v3.0.blueprint.json": "ai_analysis"
                }
                
                for filename, category in blueprint_files.items():
                    source_path = Path(filename)
                    if source_path.exists():
                        target_dir = self.base_path / category
                        target_dir.mkdir(parents=True, exist_ok=True)
                        target_path = target_dir / filename
                        
                        shutil.copy2(source_path, target_path)
                        print(f"å·²ç§»åŠ¨ {filename} åˆ° {target_path}")
                    else:
                        print(f"æ–‡ä»¶ä¸å­˜åœ¨: {filename}")
            
            def list_workflows(self) -> Dict:
                """åˆ—å‡ºæ‰€æœ‰å·¥ä½œæµ"""
                workflows = {}
                
                for category_dir in self.base_path.iterdir():
                    if category_dir.is_dir():
                        category_workflows = []
                        for blueprint_file in category_dir.glob("*.json"):
                            category_workflows.append({
                                "file": blueprint_file.name,
                                "path": str(blueprint_file)
                            })
                        workflows[category_dir.name] = category_workflows
                
                return workflows
        
        def main():
            parser = argparse.ArgumentParser(description="ICT TechInsight Blueprint Manager")
            parser.add_argument("action", choices=["organize", "list"],
                               help="è¦æ‰§è¡Œçš„æ“ä½œ")
            
            args = parser.parse_args()
            
            manager = BlueprintManager()
            
            if args.action == "organize":
                manager.organize_blueprints()
            elif args.action == "list":
                workflows = manager.list_workflows()
                print(json.dumps(workflows, indent=2, ensure_ascii=False))
        
        if __name__ == "__main__":
            main()
        EOF
        
        # åˆ›å»ºæ•°æ®éªŒè¯å™¨
        cat > scripts/data_validator.py << 'EOF'
        #!/usr/bin/env python3
        """
        ICT TechInsight Data Validator
        éªŒè¯å·¥ä½œæµè¾“å‡ºæ•°æ®çš„æ ¼å¼å’Œè´¨é‡
        """
        
        import json
        import re
        from datetime import datetime
        from typing import Dict, List, Any, Optional
        from pathlib import Path
        import argparse
        
        class DataValidator:
            def __init__(self):
                pass
            
            def validate_competitor_data(self, data: Dict) -> Dict:
                """éªŒè¯ç«äº‰å¯¹æ‰‹æ•°æ®"""
                result = {
                    "valid": True,
                    "errors": [],
                    "warnings": [],
                    "metrics": {}
                }
                
                # å¿…éœ€å­—æ®µæ£€æŸ¥
                required_fields = [
                    "company_name", "industry_category", "competitive_threat_level",
                    "innovation_index", "recent_news_count", "github_activity_score"
                ]
                
                for field in required_fields:
                    if field not in data or data[field] is None:
                        result["errors"].append(f"ç¼ºå°‘å¿…éœ€å­—æ®µ: {field}")
                        result["valid"] = False
                
                # æ•°æ®ç±»å‹éªŒè¯
                if "innovation_index" in data:
                    try:
                        index = float(data["innovation_index"])
                        if not 0 <= index <= 100:
                            result["warnings"].append("innovation_indexåº”åœ¨0-100èŒƒå›´å†…")
                    except (ValueError, TypeError):
                        result["errors"].append("innovation_indexå¿…é¡»æ˜¯æ•°å€¼ç±»å‹")
                        result["valid"] = False
                
                # å¨èƒç­‰çº§éªŒè¯
                if "competitive_threat_level" in data:
                    valid_levels = ["LOW", "MEDIUM", "HIGH"]
                    if data["competitive_threat_level"] not in valid_levels:
                        result["errors"].append(f"competitive_threat_levelå¿…é¡»æ˜¯: {valid_levels}")
                        result["valid"] = False
                
                return result
            
            def validate_academic_data(self, data: Dict) -> Dict:
                """éªŒè¯å­¦æœ¯æ•°æ®"""
                result = {
                    "valid": True,
                    "errors": [],
                    "warnings": [],
                    "metrics": {}
                }
                
                required_fields = [
                    "paper_title", "authors", "journal", "publish_date", 
                    "citation_count", "doi"
                ]
                
                for field in required_fields:
                    if field not in data or data[field] is None:
                        result["errors"].append(f"ç¼ºå°‘å¿…éœ€å­—æ®µ: {field}")
                        result["valid"] = False
                
                # DOIæ ¼å¼éªŒè¯
                if "doi" in data and data["doi"]:
                    doi_pattern = r"10\.\d{4,}/.*"
                    if not re.match(doi_pattern, data["doi"]):
                        result["warnings"].append("DOIæ ¼å¼å¯èƒ½ä¸æ­£ç¡®")
                
                return result
        
        def main():
            parser = argparse.ArgumentParser(description="ICT TechInsight Data Validator")
            parser.add_argument("data_type", choices=["competitor", "academic", "opensource"],
                               help="æ•°æ®ç±»å‹")
            parser.add_argument("--file", required=True, help="è¦éªŒè¯çš„æ•°æ®æ–‡ä»¶")
            parser.add_argument("--output", help="éªŒè¯æŠ¥å‘Šè¾“å‡ºæ–‡ä»¶")
            
            args = parser.parse_args()
            
            validator = DataValidator()
            
            try:
                with open(args.file, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                
                if args.data_type == "competitor":
                    result = validator.validate_competitor_data(data)
                elif args.data_type == "academic":
                    result = validator.validate_academic_data(data)
                
                if args.output:
                    with open(args.output, 'w', encoding='utf-8') as f:
                        json.dump(result, f, indent=2, ensure_ascii=False)
                    print(f"éªŒè¯æŠ¥å‘Šå·²ä¿å­˜åˆ°: {args.output}")
                else:
                    print(json.dumps(result, indent=2, ensure_ascii=False))
            
            except Exception as e:
                print(f"éªŒè¯å¤±è´¥: {str(e)}")
        
        if __name__ == "__main__":
            main()
        EOF
        
        # è®¾ç½®å¯æ‰§è¡Œæƒé™
        chmod +x scripts/blueprint_manager.py
        chmod +x scripts/data_validator.py
        
        echo "âœ… è„šæœ¬æ–‡ä»¶åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºç¤ºä¾‹æ•°æ®
      run: |
        echo "ğŸ“Š åˆ›å»ºç¤ºä¾‹æ•°æ®..."
        
        # ç«äº‰å¯¹æ‰‹ç¤ºä¾‹æ•°æ®
        cat > data/sample/competitor_sample.json << 'EOF'
        {
          "company_name": "Example Corp",
          "industry_category": "Technology",
          "competitive_threat_level": "MEDIUM",
          "innovation_index": 75.5,
          "recent_news_count": 12,
          "github_activity_score": 850,
          "recent_patents_count": 3,
          "monitor_timestamp": "2024-06-17T10:30:00Z"
        }
        EOF
        
        # å­¦æœ¯æ•°æ®ç¤ºä¾‹
        cat > data/sample/academic_sample.json << 'EOF'
        {
          "paper_title": "Advanced Machine Learning Techniques in ICT",
          "authors": "Smith, J.; Johnson, A.; Brown, M.",
          "journal": "IEEE Transactions on Technology",
          "publish_date": "2024-05-15",
          "citation_count": 25,
          "doi": "10.1109/example.2024.001",
          "abstract": "This paper presents novel approaches to machine learning in ICT applications..."
        }
        EOF
        
        # å¼€æºé¡¹ç›®ç¤ºä¾‹
        cat > data/sample/opensource_sample.json << 'EOF'
        {
          "repo_name": "awesome-ict-project/main",
          "description": "An innovative ICT framework for modern applications",
          "stars": 1250,
          "forks": 180,
          "language": "Python",
          "activity_score": 950,
          "maturity_level": "GROWING",
          "last_commit_days": 3
        }
        EOF
        
        echo "âœ… ç¤ºä¾‹æ•°æ®åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºæµ‹è¯•æ–‡ä»¶
      run: |
        echo "ğŸ§ª åˆ›å»ºæµ‹è¯•æ–‡ä»¶..."
        
        cat > tests/test_blueprints.py << 'EOF'
        """
        è“å›¾æµ‹è¯•æ¨¡å—
        """
        import pytest
        import json
        from pathlib import Path
        
        def test_project_structure():
            """æµ‹è¯•é¡¹ç›®ç»“æ„"""
            assert Path("config").exists()
            assert Path("scripts").exists()
            assert Path("utils").exists()
            assert Path("workflows/blueprints").exists()
            assert Path("data/sample").exists()
        
        def test_sample_data():
            """æµ‹è¯•ç¤ºä¾‹æ•°æ®"""
            sample_files = [
                "data/sample/competitor_sample.json",
                "data/sample/academic_sample.json",
                "data/sample/opensource_sample.json"
            ]
            
            for sample_file in sample_files:
                path = Path(sample_file)
                assert path.exists(), f"ç¤ºä¾‹æ–‡ä»¶ä¸å­˜åœ¨: {sample_file}"
                
                with open(path, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                
                assert isinstance(data, dict), f"{sample_file} å¿…é¡»æ˜¯JSONå¯¹è±¡"
                assert len(data) > 0, f"{sample_file} ä¸èƒ½ä¸ºç©º"
        
        def test_python_modules():
            """æµ‹è¯•Pythonæ¨¡å—"""
            # æµ‹è¯•å¯¼å…¥
            import sys
            sys.path.append('.')
            
            try:
                from utils.logger import setup_logger
                from utils.json_processor import JSONProcessor
                from scripts.blueprint_manager import BlueprintManager
                from scripts.data_validator import DataValidator
                
                # æµ‹è¯•åŸºæœ¬åŠŸèƒ½
                logger = setup_logger("test")
                assert logger is not None
                
                processor = JSONProcessor()
                assert processor is not None
                
                manager = BlueprintManager()
                workflows = manager.list_workflows()
                assert isinstance(workflows, dict)
                
                validator = DataValidator()
                assert validator is not None
                
            except ImportError as e:
                pytest.fail(f"æ¨¡å—å¯¼å…¥å¤±è´¥: {e}")
        EOF
        
        # åˆ›å»ºé…ç½®æµ‹è¯•
        cat > tests/test_config.py << 'EOF'
        """
        é…ç½®æµ‹è¯•æ¨¡å—
        """
        import pytest
        from pathlib import Path
        
        def test_config_files():
            """æµ‹è¯•é…ç½®æ–‡ä»¶"""
            assert Path("config/settings.py").exists()
            assert Path("config/api_keys.example.env").exists()
            assert Path("config/__init__.py").exists()
        
        def test_requirements():
            """æµ‹è¯•requirements.txt"""
            assert Path("requirements.txt").exists()
            
            with open("requirements.txt", "r") as f:
                content = f.read()
            
            # æ£€æŸ¥å…³é”®ä¾èµ–
            assert "requests" in content
            assert "pandas" in content
            assert "pytest" in content
        EOF
        
        echo "âœ… æµ‹è¯•æ–‡ä»¶åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»ºæ–‡æ¡£æ–‡ä»¶
      run: |
        echo "ğŸ“š åˆ›å»ºæ–‡æ¡£æ–‡ä»¶..."
        
        # åˆ›å»ºä½¿ç”¨è¯´æ˜
        cat > docs/usage.md << 'EOF'
        # ICT TechInsight ä½¿ç”¨æŒ‡å—
        
        ## å¿«é€Ÿå¼€å§‹
        
        ### 1. ç¯å¢ƒè®¾ç½®
        
        ```bash
        # å…‹éš†é¡¹ç›®
        git clone <your-repo-url>
        cd ICT-TechInsight-Automation
        
        # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
        python -m venv venv
        
        # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
        source venv/bin/activate  # Linux/Mac
        venv\Scripts\activate     # Windows
        
        # å®‰è£…ä¾èµ–
        pip install -r requirements.txt
        ```
        
        ### 2. é…ç½®APIå¯†é’¥
        
        ```bash
        # å¤åˆ¶é…ç½®æ¨¡æ¿
        cp config/api_keys.example.env .env
        
        # ç¼–è¾‘é…ç½®æ–‡ä»¶
        vim .env  # æˆ–ä½¿ç”¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨
        ```
        
        ### 3. è¿è¡Œå·¥å…·
        
        ```bash
        # åˆ—å‡ºå·¥ä½œæµ
        python scripts/blueprint_manager.py list
        
        # éªŒè¯æ•°æ®
        python scripts/data_validator.py competitor --file data/sample/competitor_sample.json
        
        # è¿è¡Œæµ‹è¯•
        pytest tests/
        ```
        
        ## å·¥å…·è¯´æ˜
        
        ### è“å›¾ç®¡ç†å™¨ (blueprint_manager.py)
        
        - `organize`: æ•´ç†è“å›¾æ–‡ä»¶åˆ°ç›¸åº”ç›®å½•
        - `list`: åˆ—å‡ºæ‰€æœ‰å·¥ä½œæµ
        
        ### æ•°æ®éªŒè¯å™¨ (data_validator.py)
        
        - `competitor`: éªŒè¯ç«äº‰å¯¹æ‰‹æ•°æ®
        - `academic`: éªŒè¯å­¦æœ¯æ•°æ®
        - `opensource`: éªŒè¯å¼€æºé¡¹ç›®æ•°æ®
        
        ## ç›®å½•ç»“æ„
        
        ```
        ICT-TechInsight-Automation/
        â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
        â”œâ”€â”€ workflows/              # Make.comå·¥ä½œæµ
        â”œâ”€â”€ scripts/               # ç®¡ç†è„šæœ¬
        â”œâ”€â”€ utils/                 # å·¥å…·æ¨¡å—
        â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
        â”œâ”€â”€ data/                  # æ•°æ®æ–‡ä»¶
        â””â”€â”€ docs/                  # æ–‡æ¡£
        ```
        EOF
        
        # åˆ›å»ºå®‰è£…è¯´æ˜
        cat > docs/installation.md << 'EOF'
        # å®‰è£…æŒ‡å—
        
        ## ç³»ç»Ÿè¦æ±‚
        
        - Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
        - Git
        - Make.com è´¦æˆ·å’ŒAPIå¯†é’¥
        
        ## å®‰è£…æ­¥éª¤
        
        ### 1. å…‹éš†ä»“åº“
        
        ```bash
        git clone https://github.com/your-username/ICT-TechInsight-Automation.git
        cd ICT-TechInsight-Automation
        ```
        
        ### 2. è®¾ç½®Pythonç¯å¢ƒ
        
        ```bash
        # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
        python -m venv venv
        
        # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
        # Windows:
        venv\Scripts\activate
        
        # Linux/Mac:
        source venv/bin/activate
        
        # å‡çº§pip
        pip install --upgrade pip
        
        # å®‰è£…ä¾èµ–
        pip install -r requirements.txt
        ```
        
        ### 3. é…ç½®ç¯å¢ƒå˜é‡
        
        ```bash
        # å¤åˆ¶é…ç½®æ¨¡æ¿
        cp config/api_keys.example.env .env
        
        # ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„APIå¯†é’¥
        # MAKE_API_KEY=your_api_key_here
        # MAKE_TEAM_ID=your_team_id_here
        ```
        
        ### 4. éªŒè¯å®‰è£…
        
        ```bash
        # è¿è¡Œæµ‹è¯•
        pytest tests/
        
        # æ£€æŸ¥è„šæœ¬
        python scripts/blueprint_manager.py list
        ```
        
        ## æ•…éšœæ’é™¤
        
        ### å¸¸è§é—®é¢˜
        
        1. **Pythonç‰ˆæœ¬é—®é¢˜**
           - ç¡®ä¿ä½¿ç”¨Python 3.8+
           - æ£€æŸ¥: `python --version`
        
        2. **ä¾èµ–å®‰è£…å¤±è´¥**
           - å‡çº§pip: `pip install --upgrade pip`
           - ä½¿ç”¨å›½å†…é•œåƒ: `pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt`
        
        3. **APIè¿æ¥é—®é¢˜**
           - æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
           - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
        EOF
        
        echo "âœ… æ–‡æ¡£æ–‡ä»¶åˆ›å»ºå®Œæˆ"
        
    - name: åˆ›å»º.gitignore
      run: |
        echo "ğŸ“ åˆ›å»º.gitignore..."
        
        cat > .gitignore << 'EOF'
        # Python
        __pycache__/
        *.py[cod]
        *$py.class
        *.so
        .Python
        build/
        develop-eggs/
        dist/
        downloads/
        eggs/
        .eggs/
        lib/
        lib64/
        parts/
        sdist/
        var/
        wheels/
        share/python-wheels/
        *.egg-info/
        .installed.cfg
        *.egg
        MANIFEST
        
        # PyInstaller
        *.manifest
        *.spec
        
        # Installer logs
        pip-log.txt
        pip-delete-this-directory.txt
        
        # Unit test / coverage reports
        htmlcov/
        .tox/
        .nox/
        .coverage
        .coverage.*
        .cache
        nosetests.xml
        coverage.xml
        *.cover
        *.py,cover
        .hypothesis/
        .pytest_cache/
        cover/
        
        # Virtual environments
        .env
        .venv
        env/
        venv/
        ENV/
        env.bak/
        venv.bak/
        
        # IDEs
        .vscode/
        .idea/
        *.swp
        *.swo
        *~
        
        # OS generated files
        .DS_Store
        .DS_Store?
        ._*
        .Spotlight-V100
        .Trashes
        ehthumbs.db
        Thumbs.db
        desktop.ini
        
        # Project specific
        *.log
        logs/
        temp/
        *.backup
        *.tmp
        
        # Data files
        data/raw/
        data/processed/
        *.csv
        *.xlsx
        
        # Secrets and credentials
        config/api_keys.env
        deployment/secrets/
        *.key
        *.pem
        credentials.json
        .secret
        
        # Jupyter Notebook
        .ipynb_checkpoints
        
        # pyenv
        .python-version
        
        # pipenv
        Pipfile.lock
        
        # poetry
        poetry.lock
        
        # Celery
        celerybeat-schedule
        celerybeat.pid
        
        # SageMath parsed files
        *.sage.py
        
        # Spyder project settings
        .spyderproject
        .spyproject
        
        # Rope project settings
        .ropeproject
        
        # mkdocs documentation
        /site
        
        # mypy
        .mypy_cache/
        .dmypy.json
        dmypy.json
        
        # Pyre type checker
        .pyre/
        
        # pytype static type analyzer
        .pytype/
        EOF
        
        echo "âœ… .gitignore åˆ›å»ºå®Œæˆ"
        
    - name: éªŒè¯æ–‡ä»¶åˆ›å»º
      run: |
        echo "ğŸ” éªŒè¯æ–‡ä»¶åˆ›å»º..."
        
        echo "ğŸ“ ç›®å½•ç»“æ„:"
        find . -type d -name ".git" -prune -o -type d -print | sort | head -30
        
        echo ""
        echo "ğŸ“„ Pythonæ–‡ä»¶:"
        find . -name "*.py" -type f | sort
        
        echo ""
        echo "ğŸ“‹ é…ç½®æ–‡ä»¶:"
        find . -name "*.txt" -o -name "*.env" -o -name "*.md" -o -name "*.yml" | sort
        
        echo ""
        echo "ğŸ“Š ç¤ºä¾‹æ•°æ®:"
        find . -name "*.json" -type f | sort
        
        echo ""
        echo "ğŸ§ª æµ‹è¯•æ–‡ä»¶:"
        find . -path "./tests/*" -name "*.py" | sort
        
        echo ""
        echo "ğŸ“š æ–‡æ¡£æ–‡ä»¶:"
        find . -path "./docs/*" -name "*.md" | sort
        
        # æ£€æŸ¥å…³é”®æ–‡ä»¶
        echo ""
        echo "ğŸ”‘ å…³é”®æ–‡ä»¶æ£€æŸ¥:"
        for file in "requirements.txt" "config/settings.py" "scripts/blueprint_manager.py" "utils/logger.py" ".gitignore"; do
          if [ -f "$file" ]; then
            echo "âœ… $file"
          else
            echo "âŒ $file ç¼ºå¤±"
          fi
        done
        
    - name: è¿è¡ŒåŸºç¡€æµ‹è¯•
      run: |
        echo "ğŸ§ª è¿è¡ŒåŸºç¡€æµ‹è¯•..."
        
        # è®¾ç½®Pythonè·¯å¾„
        export PYTHONPATH=$PYTHONPATH:$(pwd)
        
        # æµ‹è¯•Pythonè¯­æ³•
        echo "æ£€æŸ¥Pythonè¯­æ³•..."
        python -m py_compile config/settings.py
        python -m py_compile utils/logger.py
        python -m py_compile scripts/blueprint_manager.py
        python -m py_compile scripts/data_validator.py
        
        # æµ‹è¯•JSONæ ¼å¼
        echo "æ£€æŸ¥JSONæ ¼å¼..."
        python -c "import json; json.load(open('data/sample/competitor_sample.json'))"
        python -c "import json; json.load(open('data/sample/academic_sample.json'))"
        python -c "import json; json.load(open('data/sample/opensource_sample.json'))"
        
        echo "âœ… åŸºç¡€æµ‹è¯•é€šè¿‡"
        
    - name: æäº¤æ‰€æœ‰æ›´æ”¹
      uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: |
          ğŸš€ å®Œæ•´åˆ›å»ºICT TechInsighté¡¹ç›®ç»“æ„
          
          âœ¨ æ–°å¢åŠŸèƒ½:
          - ğŸ“ å®Œæ•´çš„é¡¹ç›®ç›®å½•ç»“æ„
          - ğŸ PythonåŒ…å’Œæ¨¡å— (config, scripts, utils, tests)
          - âš™ï¸ é…ç½®æ–‡ä»¶å’Œç¯å¢ƒå˜é‡æ¨¡æ¿
          - ğŸ”§ è“å›¾ç®¡ç†å·¥å…· (blueprint_manager.py)
          - ğŸ“Š æ•°æ®éªŒè¯å™¨ (data_validator.py)
          - ğŸ› ï¸ JSONå¤„ç†å·¥å…· (json_processor.py)
          - ğŸ“‹ æ—¥å¿—ç³»ç»Ÿ (logger.py)
          - ğŸ§ª å®Œæ•´çš„æµ‹è¯•æ¡†æ¶
          - ğŸ“š è¯¦ç»†çš„æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—
          - ğŸ“¦ requirements.txt ä¾èµ–ç®¡ç†
          - ğŸ™ˆ .gitignore å¿½ç•¥è§„åˆ™
          - ğŸ“Š ç¤ºä¾‹æ•°æ®æ–‡ä»¶
          
          ğŸ“ ç›®å½•ç»“æ„:
          - config/ - é…ç½®æ–‡ä»¶å’ŒAPIå¯†é’¥æ¨¡æ¿
          - workflows/blueprints/ - Make.comè“å›¾å­˜æ”¾ç›®å½•
          - scripts/ - æ ¸å¿ƒç®¡ç†è„šæœ¬
          - utils/ - å·¥å…·æ¨¡å—å’Œè¾…åŠ©å‡½æ•°
          - tests/ - å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
          - data/sample/ - ç¤ºä¾‹æ•°æ®æ–‡ä»¶
          - docs/ - ä½¿ç”¨æ–‡æ¡£å’Œå®‰è£…æŒ‡å—
          
          ğŸ› ï¸ ä¸»è¦å·¥å…·:
          - blueprint_manager.py - è“å›¾æ–‡ä»¶ç®¡ç†å’Œç»„ç»‡
          - data_validator.py - æ•°æ®è´¨é‡éªŒè¯
          - json_processor.py - JSONæ–‡ä»¶å¤„ç†
          - logger.py - ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
          
          ğŸ¯ å·²å°±ç»ªåŠŸèƒ½:
          - é¡¹ç›®ç»“æ„å®Œæ•´
          - åŸºç¡€å·¥å…·å¯ç”¨
          - æµ‹è¯•æ¡†æ¶å°±ç»ª
          - æ–‡æ¡£é½å…¨
          - å¯ç›´æ¥å¼€å§‹å¼€å‘
        branch: main
        
    - name: é¡¹ç›®åˆ›å»ºæ€»ç»“
      run: |
        echo "ğŸ‰ ICT TechInsight é¡¹ç›®åˆ›å»ºå®Œæˆï¼"
        echo ""
        echo "ğŸ“Š åˆ›å»ºç»Ÿè®¡:"
        echo "- ğŸ“ ç›®å½•: $(find . -type d | wc -l) ä¸ª"
        echo "- ğŸ“„ æ–‡ä»¶: $(find . -type f | wc -l) ä¸ª"  
        echo "- ğŸ Pythonæ–‡ä»¶: $(find . -name '*.py' | wc -l) ä¸ª"
        echo "- ğŸ“‹ é…ç½®æ–‡ä»¶: $(find . -name '*.txt' -o -name '*.env' -o -name '*.md' | wc -l) ä¸ª"
        echo "- ğŸ“Š æ•°æ®æ–‡ä»¶: $(find . -name '*.json' | wc -l) ä¸ª"
        echo ""
        echo "ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ:"
        echo "1. ğŸ“¥ å…‹éš†ä»“åº“åˆ°æœ¬åœ°: git clone <your-repo-url>"
        echo "2. ğŸ è®¾ç½®Pythonè™šæ‹Ÿç¯å¢ƒ: python -m venv venv"
        echo "3. ğŸ“¦ å®‰è£…ä¾èµ–: pip install -r requirements.txt"  
        echo "4. âš™ï¸ é…ç½®APIå¯†é’¥: cp config/api_keys.example.env .env"
        echo "5. ğŸ“‚ ä¸Šä¼ è“å›¾æ–‡ä»¶åˆ° workflows/blueprints/ å¯¹åº”ç›®å½•"
        echo "6. ğŸ§ª è¿è¡Œæµ‹è¯•: pytest tests/"
        echo "7. ğŸ”§ å¼€å§‹ä½¿ç”¨å·¥å…·: python scripts/blueprint_manager.py list"
        echo ""
        echo "ğŸ“– è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹:"
        echo "- ğŸ“š README.md - é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹"
        echo "- ğŸ“‹ docs/installation.md - è¯¦ç»†å®‰è£…æŒ‡å—"  
        echo "- ğŸ› ï¸ docs/usage.md - å·¥å…·ä½¿ç”¨è¯´æ˜"
        echo ""
        echo "âœ… é¡¹ç›®å·²å®Œå…¨å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ï¼"
